<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Malla Curricular Interactiva - Obstetricia</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />

<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #f9f4fb;
    color: #3a0ca3;
    max-width: 900px;
    margin: 20px auto;
    padding: 20px;
  }
  h1, h2 {
    text-align: center;
    font-weight: 700;
    color: #720026;
  }
  .semestre {
    background: white;
    border-radius: 12px;
    margin-bottom: 25px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(114, 0, 38, 0.2);
  }
  .ramo {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid #e8d7f1;
    user-select: none;
  }
  .ramo.bloqueado {
    opacity: 0.5;
  }
  .nombre-prereq {
    flex-grow: 1;
    margin-left: 10px;
    font-weight: 600;
    cursor: pointer;
  }
  .prerequisitos {
    font-size: 0.9em;
    color: #5a2a82;
    background: #f3e6ff;
    border-left: 4px solid #b5179e;
    border-radius: 0 12px 12px 0;
    margin-top: 5px;
    padding: 10px 16px;
  }
</style>
</head>
<body>

<h1>Malla Curricular Interactiva - Obstetricia</h1>
<div id="malla-container"></div>

<script>
// Datos de la malla con prerrequisitos como array
const malla = [
  { semestre: 1, ramos: [
      {nombre: "Inglés General", prereq: []},
      {nombre: "Biología Celular", prereq: []},
      {nombre: "Anatomía Humana", prereq: []},
      {nombre: "Química General y Orgánica", prereq: []},
      {nombre: "Fundamentos de la Matronería", prereq: []},
    ]},
  { semestre: 2, ramos: [
      {nombre: "Estrategias para el Aprendizaje", prereq: []},
      {nombre: "Fisiología Humana", prereq: ["Biología Celular","Anatomía Humana"]},
      {nombre: "Histoembriología", prereq: ["Biología Celular"]},
      {nombre: "Bioquímica General", prereq: ["Biología Celular","Química General y Orgánica"]},
      {nombre: "Antropología", prereq: []},
      {nombre: "Fundamentos de la Salud Sexual y Reproductiva", prereq: ["Fundamentos de la Matronería"]},
      {nombre: "Psicología del Curso de la Vida", prereq: []},
      {nombre: "Atención en Salud Basada en Evidencia Científica", prereq: ["Inglés General"]},
    ]},
  { semestre: 3, ramos: [
      {nombre: "Ética", prereq: ["Antropología"]},
      {nombre: "Embriología y Genética", prereq: ["Histoembriología"]},
      {nombre: "Microbiología General", prereq: ["Biología Celular"]},
      {nombre: "Farmacología General", prereq: ["Fisiología Humana","Bioquímica General"]},
      {nombre: "Farmacología Aplicada", prereq: ["Fisiología Humana","Bioquímica General"]},
      {nombre: "Anatomía Aplicada", prereq: ["Anatomía Humana"]},
      {nombre: "Género y Salud", prereq: ["Antropología","Fundamentos de la Salud Sexual y Reproductiva"]},
      {nombre: "Salud Pública I", prereq: []},
    ]},
  { semestre: 4, ramos: [
      {nombre: "PAE I", prereq: ["Anatomía Humana","Fisiología Humana","Microbiología General"]},
      {nombre: "Obstetricia I", prereq: ["Bioquímica General","Embriología y Genética","Anatomía Aplicada"]},
      {nombre: "Neonatología I", prereq: ["Bioquímica General","Embriología y Genética","Fisiología Humana"]},
      {nombre: "Ginecología I", prereq: ["Bioquímica General","Embriología y Genética","Fisiología Humana"]},
      {nombre: "Sexología I", prereq: ["Psicología del Curso de la Vida","Género y Salud"]},
      {nombre: "Promoción de la Salud", prereq: ["Antropología","Psicología del Curso de la Vida","Género y Salud"]},
      {nombre: "Fisiopatología", prereq: ["Fisiología Humana"]},
    ]},
  { semestre: 5, ramos: [
      {nombre: "Electivo de Formación Integral", prereq: ["Ética"]},
      {nombre: "Obstetricia II", prereq: ["Obstetricia I","Fisiopatología"]},
      {nombre: "Neonatología II", prereq: ["Neonatología I","Fisiopatología"]},
      {nombre: "Ginecología II", prereq: ["Ginecología I","Fisiopatología"]},
      {nombre: "PAE II", prereq: ["PAE I","Obstetricia I","Ginecología I","Neonatología I"]},
      {nombre: "Salud Familiar", prereq: ["Género y Salud","Promoción de la Salud"]},
      {nombre: "Salud Pública II", prereq: ["Salud Pública I"]},
      {nombre: "Farmacología Perinatal y Ginecológica", prereq: ["Farmacología General","Farmacología Aplicada"]},
    ]},
  { semestre: 6, ramos: [
      {nombre: "Integrado Urgencia Ginecológica, Obstétrica y Neonatal", prereq: ["PAE II","Farmacología Perinatal y Ginecológica"]},
      {nombre: "Preclínico Perinatal", prereq: ["Obstetricia II","Neonatología II"]},
      {nombre: "Regulación de la Fecundidad", prereq: ["Género y Salud","Ginecología II","Farmacología Perinatal y Ginecológica"]},
      {nombre: "Sexología II", prereq: ["Sexología I"]},
      {nombre: "Educación para la Salud", prereq: ["Género y Salud","Salud Familiar"]},
      {nombre: "Epidemiología para la Gestión", prereq: ["Salud Pública II"]},
      {nombre: "Introducción a la Biomedicina", prereq: ["Ética","Fisiopatología","Atención en Salud Basada en Evidencia Científica"]},
    ]},
  { semestre: 7, ramos: [
      {nombre: "Electivo I", prereq: []},
      {nombre: "Preclínico de Atención Primaria", prereq: ["Preclínico Perinatal","Regulación de la Fecundidad"]},
      {nombre: "Clínico Perinatal I", prereq: ["Preclínico Perinatal"]},
      {nombre: "Consejería en Salud Sexual y Reproductiva", prereq: ["Género y Salud","Educación para la Salud"]},
      {nombre: "Investigación Científica", prereq: ["Introducción a la Biomedicina"]},
      {nombre: "Bioética", prereq: ["Ética"]},
      {nombre: "Gestión en Salud", prereq: ["Epidemiología para la Gestión"]},
    ]},
  { semestre: 8, ramos: [
      {nombre: "Clínico de Atención Primaria", prereq: ["Preclínico de Atención Primaria","Sexología II","Habilidades para la Vida Profesional"]},
      {nombre: "Clínico Perinatal II", prereq: ["Clínico Perinatal I","Habilidades para la Vida Profesional"]},
      {nombre: "Clínico Morbilidad Ginecológica", prereq: ["Integrado Urgencia Ginecológica, Obstétrica y Neonatal","Ginecología II","Habilidades para la Vida Profesional"]},
      {nombre: "Medicina Legal y Matronería", prereq: ["Consejería en Salud Sexual y Reproductiva","Bioética"]},
      {nombre: "Seminario de Investigación", prereq: ["Aprobado hasta 7º semestre"]},
      {nombre: "Marketing Social en Salud", prereq: ["Educación para la Salud","Gestión en Salud"]},
      {nombre: "Integrado Clínico I", prereq: ["Clínico Perinatal II","Clínico Morbilidad Ginecológica","Clínico de Atención Primaria"]},
      {nombre: "Habilidades para la Vida Profesional", prereq: ["Bioética"]},
    ]},
  { semestre: 9, ramos: [
      {nombre: "Electivo II", prereq: ["Aprobado hasta 8º semestre"]},
      {nombre: "Clínico de Oncología Ginecológica", prereq: ["Aprobado hasta 8º semestre"]},
      {nombre: "Clínico de Control Sexual y Consejería", prereq: ["Aprobado hasta 8º semestre"]},
      {nombre: "Clínico de Morbilidad Neonatal", prereq: ["Aprobado hasta 8º semestre"]},
      {nombre: "Clínico de Salud Sexual y Reproductiva Infanto-Juvenil", prereq: ["Aprobado hasta 8º semestre"]},
      {nombre: "Clínico de Gestión en Matronería", prereq: ["Aprobado hasta 8º semestre"]},
      {nombre: "Integrado Clínico II", prereq: ["Aprobado hasta 8º semestre"]},
    ]},
  { semestre: 10, ramos: [
      {nombre: "Clínico Intrahospitalario y Extrahospitalario", prereq: ["Aprobado hasta 8º semestre"]},
    ]},
];

// Para guardar/aplicar estados con localStorage
const STORAGE_KEY = 'mallaObstetriciaEstado';

// Carga estado aprobado desde localStorage o vacio
let estadoAprobados = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};

// Función para guardar estado
function guardarEstado() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(estadoAprobados));
}

// Revisa si todos los prerrequisitos están aprobados
function prerrequisitosAprobados(prereqs) {
  if (prereqs.length === 0) return true; // sin prerrequisitos, siempre desbloqueado
  return prereqs.every(nombre => estadoAprobados[nombre] === true);
}

// Construir la malla y controlar habilitación
function construirMalla() {
  const contenedor = document.getElementById('malla-container');
  contenedor.innerHTML = '';

  malla.forEach(sem => {
    const divSemestre = document.createElement('div');
    divSemestre.className = 'semestre';

    const h2 = document.createElement('h2');
    h2.textContent = `Semestre ${sem.semestre}`;
    divSemestre.appendChild(h2);

    sem.ramos.forEach(ramo => {
      const divRamo = document.createElement('div');
      divRamo.className = 'ramo';

      // Checkbox para marcar aprobado
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.id = `chk-${sem.semestre}-${ramo.nombre}`;
      checkbox.disabled = !prerrequisitosAprobados(ramo.prereq);
      checkbox.checked = !!estadoAprobados[ramo.nombre];

      // Label para el checkbox con nombre y clic para togglear
      const label = document.createElement('label');
      label.htmlFor = checkbox.id;
      label.className = 'nombre-prereq';
      label.textContent = ramo.nombre;

      // Div para prerrequisitos
      const prereqDiv = document.createElement('div');
      prereqDiv.className = 'prerequisitos';
      prereqDiv.textContent = 'Prerrequisitos: ' + (ramo.prereq.length > 0 ? ramo.prereq.join(', ') : 'Ninguno');

      // Aplicar clase "bloqueado" si está deshabilitado
      if (checkbox.disabled) {
        divRamo.classList.add('bloqueado');
      }

      // Al hacer clic en checkbox, actualizar estado y reconstruir para refrescar habilitados
      checkbox.addEventListener('change', () => {
        estadoAprobados[ramo.nombre] = checkbox.checked;
        guardarEstado();
        construirMalla();
      });

      divRamo.appendChild(checkbox);
      divRamo.appendChild(label);
      divSemestre.appendChild(divRamo);
      divSemestre.appendChild(prereqDiv);
    });

    contenedor.appendChild(divSemestre);
  });
}

// Al cargar página construir malla
construirMalla();
</script>

</body>
</html>
